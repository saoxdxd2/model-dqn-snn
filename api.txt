dab2e42da43bc44934cb07d7973984cad6a4407a

# === Colab Setup with Local Zip Transfer (No Drive) ===
import os, shutil, zipfile
from pathlib import Path
from google.colab import files

print("="*70)
print("üõ†Ô∏è  Colab Setup - Local Transfer Mode")
print("   No Google Drive needed")
print("   Transfer via zip upload/download")
print("="*70 + "\n")

# 1. Clone or update repo
%cd /content
if os.path.exists('model-dqn-snn'):
    %cd model-dqn-snn
    !git reset --hard HEAD
    !git pull origin main
    print("‚úÖ Repo updated")
else:
    !git clone https://github.com/saoxdxd2/model-dqn-snn.git
    %cd model-dqn-snn
    print("‚úÖ Repo cloned")

# 2. Check for existing model_checkpoints/ or upload from local machine
checkpoints_dir = Path('model_checkpoints')

if not checkpoints_dir.exists():
    print("\nüì§ No checkpoints found. Upload zip from your E:\\ drive?")
    print("   Expected: model-dqn-snn.zip (contains model_checkpoints/)")
    response = input("Upload zip? (y/n): ").lower()
    
    if response == 'y':
        print("üì¶ Upload your model-dqn-snn.zip file...")
        uploaded = files.upload()
        
        if uploaded:
            zip_filename = list(uploaded.keys())[0]
            print(f"\nüìú Extracting {zip_filename}...")
            
            with zipfile.ZipFile(zip_filename, 'r') as zip_ref:
                zip_ref.extractall('/content/temp_extract')
            
            # Find and copy model_checkpoints from extracted content
            extracted_checkpoints = Path('/content/temp_extract/model-dqn-snn/model_checkpoints')
            if extracted_checkpoints.exists():
                shutil.copytree(extracted_checkpoints, checkpoints_dir, dirs_exist_ok=True)
                
                # Count restored files
                cache_files = len(list((checkpoints_dir / 'text_cache').glob('*.png'))) if (checkpoints_dir / 'text_cache').exists() else 0
                chunks = len(list((checkpoints_dir / 'encoding_progress').glob('*.pt'))) if (checkpoints_dir / 'encoding_progress').exists() else 0
                
                print(f"‚úÖ Restored from local machine:")
                print(f"   Text cache: {cache_files} images")
                print(f"   Encoding chunks: {chunks} files")
                
                # Cleanup
                shutil.rmtree('/content/temp_extract')
                os.remove(zip_filename)
            else:
                print("‚ö†Ô∏è  No model_checkpoints/ found in zip")
        else:
            print("‚ÑπÔ∏è  No file uploaded, starting fresh")
    else:
        print("‚ÑπÔ∏è  Skipping upload, starting fresh")
else:
    print("‚úÖ Found existing model_checkpoints/ (from previous session)")

# 3. Install dependencies
print("\nüì¶ Installing dependencies...")
!pip install -q --no-cache-dir -r requirements.txt

# 4. Start training
print("\n" + "="*70)
print("üöÄ Starting Training")
print("   First run: ~5.6 hours (cache + encode)")
print("   Resume: Continues from model_checkpoints/")
print("   After: Run zip cell to download back to E:\\")
print("="*70 + "\n")
!python train.py



import shutil
import os

# Define the path to the directory you want to zip
directory_to_zip = 'model-dqn-snn'

# Define the name for the output zip file
output_zip_file = 'model-dqn-snn.zip'

# Create a zip archive of the directory
shutil.make_archive(output_zip_file.replace('.zip', ''), 'zip', directory_to_zip)

print(f'Successfully created {output_zip_file}')
from google.colab import files

# Define the name of the zip file
output_zip_file = 'model-dqn-snn.zip'

# Download the file
files.download(output_zip_file)